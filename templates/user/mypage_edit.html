{% extends 'base.html' %}
{% block header %}{% endblock %}
{% block content %}
<section class="min-h-screen bg-gradient-to-br from-green-50 to-white flex items-center justify-center p-4">
  <div class="w-full max-w-2xl bg-white p-6 rounded-xl shadow-sm border border-green-100 space-y-6">
    <header class="space-y-1 text-center md:text-left">
      <h1 class="text-2xl md:text-3xl font-bold tracking-tight text-slate-900">프로필 수정</h1>
      <p class="text-sm text-gray-600">회원가입 때 입력한 정보를 최신 상태로 업데이트하세요.</p>
    </header>

    <form id="profile-edit-form" class="space-y-6" method="post" action="{{ url_for('user_profile.post_edit_info') }}">
      <!-- 기본 정보 -->
      <div class="space-y-4">
        <h2 class="text-lg font-semibold text-slate-900">기본 정보</h2>
        <div class="flex flex-col gap-3 items-center justify-center mb-4">
          <img id="profile-img" src="" alt="프로필 사진" class="w-24 h-24 rounded-full object-cover border-2 border-green-200">
        <!-- 사진 업로드 박스 -->
        <label for="file-upload" class="flex h-9 min-w-0 cursor-pointer items-center justify-center rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-xs outline-none transition-[color,box-shadow] placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground hover:bg-slate-100 focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 dark:bg-input/30 dark:hover:bg-slate-800 dark:aria-invalid:ring-destructive/40 md:text-sm">
          사진 수정
        </label>

        <!-- 크롭 모달 -->
        <div id="cropper-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/50 p-4">
          <div class="w-full max-w-xl rounded-xl bg-white shadow-lg">
            <div class="flex items-center justify-between border-b px-4 py-3">
              <h3 class="text-lg font-semibold">이미지 자르기</h3>
              <button id="cropper-close" type="button" class="text-slate-500 hover:text-slate-700">닫기</button>
            </div>
            <div class="p-4">
              <div class="w-full">
                <img id="cropper-image" class="max-h-[60vh] w-full object-contain" alt="crop source" />
              </div>
              <!-- 원형 미리보기 -->
              <div class="flex items-center justify-center">
                <div class="w-28 h-28 rounded-full overflow-hidden border">
                  <div id="cropper-preview" class="w-28 h-28"></div>
                </div>
              </div>
            </div>
            <div class="flex justify-end gap-2 border-t px-4 py-3">
              <button id="cropper-cancel" type="button" class="inline-flex h-9 items-center rounded-md border border-slate-300 px-4 text-slate-700 hover:bg-slate-50">취소</button>
              <button id="cropper-apply" type="button" class="inline-flex h-9 items-center rounded-md bg-green-600 px-4 font-medium text-white hover:bg-green-700">적용</button>
            </div>
          </div>
        </div>

        <input id="file-upload" name="profileImage" type="file" class="sr-only" accept="image/*" required/>

        </div>
      <div class="space-y-2">
      
        <label for="nickName" class="text-sm font-medium text-slate-700">닉네임</label>
        <input id="nickName" name="nickName" type="text" class="flex h-9 w-full min-w-0 rounded-md border border-slate-300 bg-white px-3 py-1 text-base md:text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition-[color,box-shadow] focus-visible:border-green-600 focus-visible:ring-2 focus-visible:ring-green-600/50" required />
        <p class="text-xs text-gray-500">서비스에서 보여질 이름입니다.</p>
      </div>
      </div>
      <!-- 취미 · MBTI -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="space-y-2">
          <label for="hobby" class="text-sm font-medium text-slate-700">취미</label>
          <input id="hobby" name="hobby" type="text" class="flex h-9 w-full min-w-0 rounded-md border border-slate-300 bg-white px-3 py-1 text-base md:text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition-[color,box-shadow] focus-visible:border-green-600 focus-visible:ring-2 focus-visible:ring-green-600/50" required />
        </div>
        <div class="space-y-2">
          <label for="mbti" class="text-sm font-medium text-slate-700">MBTI</label>
          <select id="mbti" name="mbti" class="flex h-9 w-full min-w-0 rounded-md border border-slate-300 bg-white px-3 py-1 text-base md:text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition-[color,box-shadow] focus-visible:border-green-600 focus-visible:ring-2 focus-visible:ring-green-600/50" required>
            <option value="" disabled selected>MBTI 선택</option>
            <option value="ISTJ">ISTJ</option><option value="ISFJ">ISFJ</option><option value="INFJ">INFJ</option><option value="INTJ">INTJ</option>
            <option value="ISTP">ISTP</option><option value="ISFP">ISFP</option><option value="INFP">INFP</option><option value="INTP">INTP</option>
            <option value="ESTP">ESTP</option><option value="ESFP">ESFP</option><option value="ENFP">ENFP</option><option value="ENTP">ENTP</option>
            <option value="ESTJ">ESTJ</option><option value="ESFJ">ESFJ</option><option value="ENFJ">ENFJ</option><option value="ENTJ">ENTJ</option>
          </select>
        </div>
      </div>
      <!-- 소개 글 -->
      <div class="space-y-2">
        <label for="oneLineIntro" class="text-sm font-medium text-slate-700">한 줄 소개</label>
        <input id="oneLineIntro" name="oneLineIntro" type="text" class="flex h-9 w-full min-w-0 rounded-md border border-slate-300 bg-white px-3 py-1 text-base md:text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition-[color,box-shadow] focus-visible:border-green-600 focus-visible:ring-2 focus-visible:ring-green-600/50" required />
        <p class="text-xs text-gray-500">프로필 카드에 강조되어 표시됩니다.</p>
      </div>
      <!-- 기타 -->
      <div class="space-y-2">
        <label for="motivate" class="text-sm font-medium text-slate-700">지원 동기</label>
        <input id="motivate" name="motivate" type="text" class="flex h-9 w-full min-w-0 rounded-md border border-slate-300 bg-white px-3 py-1 text-base md:text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition-[color,box-shadow] focus-visible:border-green-600 focus-visible:ring-2 focus-visible:ring-green-600/50" required />
      </div>
      <div class="space-y-2">
        <label for="favoriteFood" class="text-sm font-medium text-slate-700">좋아하는 음식</label>
        <input id="favoriteFood" name="favoriteFood" type="text" class="flex h-9 w-full min-w-0 rounded-md border border-slate-300 bg-white px-3 py-1 text-base md:text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition-[color,box-shadow] focus-visible:border-green-600 focus-visible:ring-2 focus-visible:ring-green-600/50" required />
      </div>
      <div class="pt-2 flex gap-3">
        <a href="/user/profile" class="inline-flex items-center justify-center h-10 px-4 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50 transition-colors w-1/2">취소</a>
        <button type="submit" class="w-1/2 h-10 rounded-md bg-green-600 text-white font-medium hover:bg-green-700 transition-colors">수정하기</button>
      </div>
    </form>
  </div>
</section>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='user_profile_edit.js') }}"></script>
<link href="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.css" rel="stylesheet" />
<script src="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.js"></script>
<script src="{{ url_for('static', filename='image_crop.js') }}"></script>
<script src="{{ url_for('static', filename='user_profile.js') }}"></script>
{% endblock %}
